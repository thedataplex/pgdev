import "dart:async";
import "dart:core";
import 'dart:io';
import "package:flutter/material.dart";
import "actions.dart";
import 'package:current_location/current_location.dart';
import 'package:current_location/model/location.dart';
import 'package:go_router/go_router.dart';


int lbcnt = 0;

void processLocationButton(BuildContext context) async
{
	lbcnt = lbcnt + 1;
	print("LocationButton Pressed [$lbcnt] Times");
	context.go('/location');
}

class DPLocationScreen extends StatefulWidget {
  DPLocationScreen({Key? key}) : super(key: key);

  final String title = "Current Location Details";

  @override
  State<DPLocationScreen> createState() => _DPLocationScreenState();
}

class _DPLocationScreenState extends State<DPLocationScreen> {

  @override
  Widget build(BuildContext context) {
		var now = DateTime.now();
		var day = now.day.toString();
		var month = now.month.toString();
		var year = now.year.toString();
    return Scaffold(
      appBar: AppBar(
        // Here we take the value from the DPLocationScreen object that was created by
        // the App.build method, and use it to set our appbar title.
        title: Text(widget.title),
      ),
      body: FutureBuilder(
        future: UserLocation.getValue(),
        builder: (BuildContext context, dynamic snapshot) {
          if (snapshot.hasData) {
            return Center(
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                crossAxisAlignment: CrossAxisAlignment.center,
                children: [
                  Text('Date: ' + day + '/' + month + '/' + year),
                  Text('Date: ' + now.day.toString() + '/' + now.month.toString() + '/' + now.year.toString()),
                  Text('Time: ' + now.hour.toString() + ':'+ now.minute.toString() + ':' + now.second.toString() + ' ' + now.timeZoneName),
                  Text('Country: ${snapshot.data!.country}'),
                  Text('Country Code: ${snapshot.data!.countryCode}'),
                  Text('Region: ${snapshot.data!.region}'),
                  Text('Region Name: ${snapshot.data!.regionName}'),
                  Text('Timezone: ${snapshot.data!.timezone}'),
                  Text('Latitude: ${snapshot.data!.latitude}'),
                  Text('Longitude: ${snapshot.data!.longitude}'),
                  Text('ISP: ${snapshot.data!.isp}'),
                  Text('Current IP: ${snapshot.data!.currentIP}'),
                ],
              ),
            );
          }
          return const CircularProgressIndicator();
        },
      ),
    );
  }
}
